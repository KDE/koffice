This file describes the tasks at hand for making KSpread a better product.

Legend
======

Status field

----	No work has been done on this (sub)task yet.
DONE    Task is all done
done    This subtask is done
****	This (sub)task cannot be fixed with the current technology.
        It has to wait until something in the internals is fixed.

INGE	Inge is working on this task
inge	Inge is working on this subtask
RAPH	Raphael is working on this task
raph	Raphael is working on this subtask
TOMA	Tomas is working on this task (or planning to do so, at least ;))
toma	Tomas is working on this subtask
LAUR	Laurent is working on this task
laur	Laurent is working on this subtask
ARIY	Ariya is working on this task
ariy	Ariya is working on this subtask
JOHN	John is working on this task
john	John is working on this subtask
STEF	Stefan is working on this task
stef	Stefan is working on this subtask

...fill in your signatures here.


Prio field

S	Involves string changes.  Must be done before the freeze.
1	Important task.  Should definitely be fixed.
2	Semi-important task.  Should be fixed if possible, but can be
	moved to 1.4.1 if necessary.
3	Nice to have.  Should be fixed if there is time. (yeah, right)



Things to do before the release of KOffice 1.5
==============================================

Item                                                               Prio Status
------------------------------------------------------------------------------

General bugs
------------

* Miscellaneous
  + Format->"Increase indent" sets cell alignment to left	      2 DONE




Things to do before the release of KOffice 1.4
==============================================


Item                                                               Prio Status
------------------------------------------------------------------------------

General bugs
------------

* Crashes

* Painting

* Printing

* Format
  + 87471: format of whole column does not change		      2 ----

* Load & Save, Import & Export
  + 87471: format of whole column does not change (actually import)   1 ----

* Miscellaneous
  + 59510: Handles large spreadsheets "extremely" poorly.	      2 ----
	This is perhaps already (partly) fixed, but might be
	very difficult to fix quickly if it isn't.
  + 60458: Inserting a row always creates cell with default number    2 ----
	   format.
  + 70708: undo of series broken when range contains merged cells     2 ----
  + 84738: Inserting a new line does not copy right settings to       2 ----
	   new line.

* Investigate further if these are important.
  + 69285: Pasting directly into the cell edit box is not 	      2 ----
	   subsequently saved when changing cells.

Filter bugs
-----------



Things not in bugzilla
----------------------

* Printing
  + printouts with zoom other than 100% (it's a missing feature, but  2 ----
    the GUI is there... - page layout, options, Scale Printout )
  + make print range work over more than 1 page			      2 ----
  + Repeated rows and columns don't work if they don't start from     2 ----
    row/column 1.   Also it is not possible to enter just one
    row/column into the dialog, it always has to be a range (2:3).
    - Make it possible to enter just one row/column into GUI, don't   2 ----
      force a range.


* Features
  + Add text frames and picture frames. It's currently not easy to    2 ----
    insert pictures!

* Plugins



Things to do after the release of KOffice 1.4
=============================================

* Bugs
  + If you select a row and chooses Data->"Remove columns", then      1 ----
    everything is removed.  I think if entire rows are selected,
    "Remove columns" should be disabled.  Besides, if you undo
    the operation, KSpread crashes.
  + If entire rows or columns are selected, then Data->"Insert cells"
    should be disabled.

* OpenDocument file format
  see OASIS.txt							      1 ----

* Internals (See also DESIGN.html)
  + Painting    						      1 DONE
    Use a 'CellWindow' to store CellViews for the the currently
    visible cells. This 'CellWindow' will create and delete CellViews
    if necessary, but reuses existing ones. This approach will enable
    us to decouple the CellViews from the Cells. This in turn will
    enable us to cache each and every attribute related to the cell
    painting, which is currently not possible because of memory
    consumption. Caching the attributes should make the painting
    way faster.

  + Zooming	    						      1 ----
    Make it view dependent and not document dependent.

  + Format Storage						      1 ----
    This would dramatically reduce memory consumption and allows
    styles for empty cells.
    - Use new Format Storage						----
    - Remove old KSpreadFormat						----

  + Speed up selection.						      1 STEF
    (probably improved with Format Storage?)

  + Non-continguous selection					      2 ----
    Convert the operations to work on non-contiguous selections.
    - InsertColumn							----
    - InsertRow								----
    - DeleteColumn							----
    - DeleteRow								----

  + Manipulators						      2 ----
    Convert CellWorker/UndoActions/Commands to Manipulators.
    - Copy								----
    - Delete								----
    - Cut								----
    - Paste								----
    - Paste Special							----
    - Paste with insertion						----

  + Rich text in cells.						      1 ----
	Use KoText.

  + Evaluation of how best to increase floating point precision.      3 ----
	Suggestion:  GnuMP.    (Tomas)
	This will work by converting all functions to compute using
	ValueCalc, and nothing else, then modifying Value* to
	support GnuMP.  The conversion step shall be done as a part
	of converting to the new parser.

  + code cleanups						      3 ----
    - Merge Cell::checkForNamedAreas() into Oasis::decodeFormula().	----
      Caution: also used by OpenCalc filter
    - Check if all logic of Point and Range is materialized in Region.	----
      Replace all occurences of Point and Range by Region.
    - All util_foo() functions that act on Point/Ranges should become	----
      static members of Region.
    - Move all util_foo() functions to 'Util' namespace and remove	----
      the prefix 'util_'.
    - Reduce amount of parameters for methods which takes many of
      them, e.g. Sheet::paste(). bools -> QFlags, static variables

* GUI
  + Indent and multiline doesn't work together			      2 ----
  + RegionSelector						      2 ----
    - add syntax highlighting
    - intialize choice on focus in events, if necessary
    - fix the line edit height
    - implement single cell restriction (maybe in Selection)
    - jump back to parent dialog on closing the mini dialog

* Value engine
  + DependencyManager / RecalcManager				      1 STEF
    - The reference depth changes only if a formula was altered. So,
      it belongs to the DependencyManager and has to be moved. OTOH,
      it is only use for recalculation. If this is disabled, the
      reference depth is useless. Therefore, we have to respect the
      automatic recalc setting.


* General features
  + Painting: Indent and multiline doesn't work together	      2 ----
  + Insert manual page break					      2 ----
  + Split view							      1 ----
  + "Freeze/Unfreeze Panes"					      2 ----
    Started but had some problems caused by the scrollbars, it
    works, but not very nice (not committed (Norbert)).
    Maybe not as important if we get split view to work correctly.

  + Matrix operations						      2 ----
    - Determinant							----
    - Dimension								----
    - Inverse								----
    - Minima/Maxima elements						----
    - Multiply								----
    - Norm								----
    - Rank								----
    - Transpose								----

  + Locked areas (for formulas with a matrix as result)		      2 TOMA

  + Function optimizer ('Solver')				      2 ----
    - evaluate, if we're able to use linear methods (derivatives!)	----
    - evaluate, how to include side conditions				----
    - check wether the formula cell carries a valid formulas		----
      and further checks of used cell contents


* Major features (big effort)
  + Script, Script-Editor (like VBA in Excel)			      2 ----
    - Suggestion: Kross
  + Tools->Auditing:						      2 ----
    - Trace Precedents						      2 ----
    - Trace Dependants						      2 ----
    - Trace Error						      2 ----
    - Remove all arrows						      2 ----
  + Pivot tables						      3 ----
  + Scenarios							      3 ----
    See [1], section 8.3.3 for details.


Other things: (please add the things you are working on!)


Not yet sorted (will be entered into categories above)

- Multible Operations (in Excel: "Data"->"Table") (Norbert)
- more chart types
- background spell check (necessary to use kotext)
- links to cells in other kspread files
- much more formulas (financial, database...)
        String2Int, CurrentMonth, CurrentYear, CurrentDay
        See list below
- Insert basic drawings, autoforms (necessary to create a share lib from kpresenter)
- Insert widgets like buttons, drop down lists,... + having the possibily to
  define action if pressed, or selection changes,...
- Transparency for embedded objects
- z-order for embedded objects (and possibility to change the order)
- better handling of embedded objects: e.g. delete them just by marking them + Del-Key
  not only in the context menu of the borders
- Scrollbar that supports jumping one row/column forward or back
- formula result: fit the precision to the width of the cell
- other bug fixes                               (everybody, every time)
- interface for mail merge

*********
* Taken:
*********

Philipp
=======

- Printing enhancements:
  + Expand selection to page
  + Fit selection to page
  + Print selection only

- Filter, Autofilter                                             (but will take long, haven't started yet)
- Performance improvements at end of ranges - last column/row    (started)
- Support "unlimited" columns/rows,
  unlimited means a reasonable defined value                     (concept finished, will include after beta1)


Norbert
=======

- solver (see gnumeric)  [isn't this done already?]
+ option: ignore duplicate deliminers in CSV import and Insert data from file/clipboard
+ CSV export dialog: define deliminers, Table(s), cell content in '"'
+ enhance the Gnumeric import filter
- sync the Gnumeric export filter
+ StarCalc/OpenCalc import filter
- StarCalc/OpenCalc filter for embedding/embedded objects
+ StarCalc/OpenCalc export filter
- qsa support + recording
- Button + Drop-Down-List support (within cells)
- better AutoFormat dialog + better templates
- new dialog for conditional cell attributes

- Multiple Operations
+ Lookup & Reference functions (LOOKUP needs to fixed)
- more information functions (Excel compatible)

Ariya
=====
- more "Related Functions" in function help/desc text
- improve function compatibility with MS Excel
- dBASE export filter


OpenCalc - filter
=================
- changing text angle should resize the cell height automatically
- conditional cell attribute support is just poor in KSpread:
  we should be able to assign complete styles (KSpreadLayout objects)
- support for format strings (dd/mm/yyyy)       - Norbert
- more font attributes (outline, shadow,...) + attributes for parts of the text
- double borders
- multiline header/footer support
- for formulas: fit precision so the result fits in the cell or resize the cell
- save m_strOutText in file => no parsing on load  (Norbert)
- save formula results etc in a certain way in the cell (Norbert)


Missing formulas (compared with XL)
===================================

Statistical:

BETAINV
BINOMDIST  (different from BINO?)
CHIINV
CHITEST
CRITBINOM
FINV
FORECAST
GAMMAINV
GROWTH
INTERCEPT
LINEST
LOGEST
PERCENTILE
PERCENTRANK
PROB
QUARTILE
RANK
RSQ
SLOPE
STEYX
TREND
TRIMEAN
TTEST
ZTEST


Lookup:

HLOOKUP
HYPERLINK
MATCH
OFFSET
TRANSPOSE
VLOOKUP


Logic:


Information:

CELL
ISERR
ISERROR
ISNA
NA

EXPRESSION
GETENV
SELECTION


Engineering:

IMLOG2
IMLOG10


Date & Time:

NETWORKDAYS
WEEKNUM
WORKDAY
YEARFRAC
DATEDIF
UNIX2DATE
DATE2UNIX


Math:

MDETERM
MINVERSE
MMULT
SERIESSUM
SUMXMY2


Financial:

AMORDEGRC
AMORLINC
COUPDAYBC
COUPDAYS
COUPDAYSNC
COUPNCD
COUPPCD
CUMIPMT
CUMPRINC
FVSCHEDULE
MDURATION
MIRR
ODDFPRICE
ODDFYIELD
ODDLPRICE
ODDLYIELD
PRICE
PRICEDISC
PRICEMAT
RATE
VDB
XIRR
XNPV
YIELD
YIELDDISC
YIELDMAT

IRR
NPV


Trig:

IMTAN
+ACOT


******************************************************************************
Please everyone working on KSpread:

Get yourself a copy of Excel 97 or 2000 and create
a really big sheet, and I mean really big and insert Graphs and
lots of dependencies and regressions etc. use external add-ins if you have any
and real time links. Make links between sheets and then see how
well Excel behaves.

1. UNDERSTAND that putting a spread->recalc() or spread->recalc(true) in
your code is an abosolute NO-NO! Complex spreadsheets with possible
heavy mathematical calculations via dll/so add-ins as well as real
time feeds will not be managable if you do not painstakingly check
wether spread->getAutoCalc() is true.


2. Learn to understand that without the
following short cut actions you are lost ( try to scroll
down a list of 10,000 obersvations ...not using CTRL Down
for example)

CTRL Up/Down/Left/Right
CTRL Shift Up/Down/Left/Right
CTRL Home/End
CTRL Shift Home/End
Shift F9 versus F9

Let's try to get them working well in Kspread as well. I tried my
hand at it but wasn't able to get them to be efficient.

3. Familiarize yourself with the concept of array formulas and why they
are necessary (area protection, partial argument evaluation) Who would
be willing to implement them? This will be an absolute must if we
want to make progress on the mathematical/financial/statistical
function side of things. I would be willing to implement a miriad
of these functions but I believe doing that without having array
formulae first will be a big mistake.

(In case you wonder why I feel so strongly about these things:
I am a professional user of Excel. I eat, sleap and work with Excel
on my trading desk on Wall-Street.)


Bernd <wuebben@kde.org>



References:
===========
[1]	Open Document Format for Office Applications (OpenDocument) v1.0,
	http://docs.oasis-open.org/office/v1.0
