Lotus AmiPro File Format (NOT FINISHED YET)

Ariya Hidayat <ariyahidayat@yahoo.de>
Last rev: March 16, 2002

1  Foreword
-----------
This is solely based on my reverse-engineering work whilst
I work on AmiPro import filter for KWord.

2  Structure of AmiPro document
-------------------------------
An AmiPro document consists of (in order of appearance):
- header
- content, i.e the text
- embedded objects (frame, image, ...)

3  Formatting
-------------
Basic text formatting, such as bold, italic, and so on is
done inline by enclosing the text in a form of tag (like
HTML tag). A tag is something like: <+$>

The following list summarizes known formmating tags:
  <+!> bold on
  <-!> bold off
  <+"> italic on
  <-"> italic off
  <+#> underline on
  <-#> underline off
  <+)> double underline on
  <-)> double underline off
  <+$> word underline on
  <-$> word underline off
  <+&> superscript on
  <-&> superscript off
  <+'> subscript on
  <-'> subscript off
  <+%> strikethrough on
  <-%> strikethrough off

Note: Word underline is just like underline, except that
spaces between words are not underlined.

Paragraph align is also encoded using tag, here it the list:
  <+@> left alignment
  <+A> right alignment
  <+B> center alignment
  <+C> justified

Linespacing is encoded using tag:
  <:S+-1> single
  <:S+-2> one-and-half
  <:S+-3> double
  <:S+480> custom, 480/20 = 24 pt

Font: tag <:f...>
Example: <:f240,2Arial,255,0,0> means "Arial" font
of size 240/20 = 12 pt, with red color (R=255,G=0,B=0).
Simple tag <:f> means back to default font.

Special characters are escaped or encoded because 
they have special meaning. Known so far: 
   < encoded as <<
   [            <[>
   @            @@
   >            <;>

4  Styles
---------
Styles are defined in the header, precisely in section
[tag]. The format for this section is shown with an
example below:

 [tag]
     Title          ---> style name
     8              ---> shortcut key ("F8")
     [fnt]
         Arial      ---> font family ("Arial")
         360        ---> font size, 360/20 = 18 pt
         0          ---> font color (see below)
         16385      ---> formatting flag (see below)
     [algn]
         4
         1
         0
         0
         0
     [spc]
         33
         432
         1
         144        ---> space before, 144/20 = 7.2 pt
         72         ---> space after, 72/20 = 3.6 pt
         1
         100
     [brk]
                16
        [line]
                8
                0
                1
                0
                1
                1
                1
                10
                10
                1

        [spec]
                0
                1

                0
                1
                1
                0
                0
                0
                0
        [nfmt]
                272
                1
                2
                .
                ,
                </c>
        Title
        0
        0


Color Representation:
  bit 0-7   : red 
  bit 8-15  : green
  bit 16-23 : blue

Formatting flag (16 bit)
  bit 0  : bold
  bit 1  : italic
  bit 2  : underline
  bit 3  : word underline
  bit 4  : all caps
  bit 6  : double underline
  bit 11 : initial caps
  bit 12 : first line bold
  bit 14 & 15 always set (??)


Styles are applied using the following sequences:
@StyleName@, which put inline (within the text/content).
Normally this appears in beginning of paragraph.

5  Frame, Image, Table
----------------------
still pretty much a mystery :-P

6  Equation
-----------
Equation or mathematical formula is represented in
a language similar to TeX or LaTeX. Each equation is however
put in a separate frame, so it is not really part
of the document. Think of equation as embedded object
within the document.
