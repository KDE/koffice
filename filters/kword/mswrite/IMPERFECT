
How to (and how not to) perfect the filter
-----------------------------------------------

Like most, if not all, import filters in any office suite, the MSWrite
Import filter is nowhere near the "perfect" status.  This file discusses
where and why this is so and whether or not anyone should bother trying
to fix these:

1. KWord renders text with slightly bigger/smaller, with slightly
more/less spaces than MSWrite: This cannot be avoided (realistically) and
the exact method of rendering of text is not specified by MS.  Obviously,
this would mean that KWord will read a document and produce more/less
pages than MSWrite would with the same document, leading on to point (2):

2. signal MSWRITE_IMPORT_LIB::pageNewWrite() is ignored: pageNewWrite()
is a signal generated by MSWRITE_IMPORT_LIB, based on the data in the
pageTable from a MSWrite document.  However due to the previous point
(1) and the fact that the pageTable can get so out of sync with the
document anyway esp. if the user doesn't "Repaginate" the document,
the pageTable is completely ignored in this import filter.

3. linespacing: MSWrite renders text with a highly irregular form of
linespacing (where the text is aligned to the bottom).  This has been
discussed on koffice-devel and has resulted in a work-around: use of
the OFFSETS tag.  Note: Word97 can import this linespacing, despite the
fact that it doesn't do linespacing like MSWrite so perhaps this may be
fixed in the future?

4. images: Specifications for the MSWrite format on the Internet do
not specify precisely the manner in which WMFs and bitmaps are stored.
Experimentation has resulted in much of the WMF and BMP code (does
MSWrite support non-monochrome bitmaps?)

5. incomplete/inaccurate specifications: Specifications for the MSWrite
format on the Internet seem to be wrong about the defaults for certain
values, are vague about the manner in which some things are stored and
are totally inaccurate about the sectionProperty pages.  Things such as
the starting page number and distance a header or footer is positioned
from the top and bottom of a page, respectively, are actually stored
in undocumented bytes.  And sectionProperty->numDataBytes is never >=1
and <=16 -- it is always 102 (from experimentation).  So if the filter
renders something incorrectly, don't blame me if I was following a spec :)

Last updated: 2002-01-06 Clarence Dang <CTRL_CD@bigpond.com>
