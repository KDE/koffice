project(flake)

include_directories(${FLAKE_INCLUDES} ${QT_INCLUDES})

if(KDE4_BUILD_TESTS)
    # only with this definition will the FLAKE_TEST_EXPORT macro do something
    add_definitions(-DCOMPILING_TESTS)
endif(KDE4_BUILD_TESTS)

add_subdirectory(tests)
add_subdirectory(pics)

set(flake_SRCS
    KoFlake.cpp
    KCanvasBase.cpp
    KoResourceManager.cpp
    KCanvasObserverBase.cpp
    KCanvasSupervisor.cpp
    KoCutController.cpp
    KCopyController.cpp
    KoDockFactoryBase.cpp
    KoDockRegistry.cpp
    KoDataCenterBase.cpp
    KoInsets.cpp
    KoPasteController.cpp
    KGuidesData.cpp
    KoPathShape.cpp
    KoPathPoint.cpp
    KoPathPointData.cpp
    KoPathSegment.cpp
    KoSelection.cpp
    KoShape.cpp
    KoShapeConnection.cpp
    KoShapeConnectionPolicy.cpp
    KoShapeControllerBase.cpp
    KoShapeApplicationData.cpp
    KoShapeContainer.cpp
    KoShapeContainerModel.cpp
    KoShapeContainerDefaultModel.cpp
    KoShapeGroup.cpp
    KoShapeManagerPaintingStrategy.cpp
    KoShapeManager.cpp
    KoShapePainter.cpp
    KFrameShape.cpp
    KoToolBase.cpp
    KCanvasController.cpp
    KCanvasController_p.cpp
    KoShapeRegistry.cpp
    KoToolFactoryBase.cpp
    KoPathShapeFactory.cpp
    KoShapeFactoryBase.cpp
    KoShapeUserData.cpp
    KoPointGroup.cpp
    KoParameterShape.cpp
    KoPointerEvent.cpp
    KoShapeController.cpp
    KoToolSelection.cpp
    KoShapeLayer.cpp
    KoPostscriptPaintDevice.cpp
    KInputDevice.cpp
    KoToolManager_p.cpp
    KoToolManager.cpp
    KoToolRegistry.cpp
    KoToolProxy.cpp
    KoShapeSavingContext.cpp
    KoShapeLoadingContext.cpp
    KLoadingShapeUpdater.cpp
    KoPathShapeLoader.cpp
    ShapeDeleter_p.cpp
    KoShapeBorderBase.cpp
    KoShapeBorderFactoryBase.cpp
    KoShapeBorderRegistry.cpp
    KLineBorder.cpp
    KLineBorderFactory.cpp
    KoShapeBackground.cpp
    KColorBackground.cpp
    KGradientBackground.cpp
    KoPatternBackground.cpp
    KoShapeConfigWidgetBase.cpp
    KoDrag.cpp
    KoDragOdfSaveHelper.cpp
    KoShapeOdfSaveHelper.cpp
    KoShapePaste.cpp
    KoSnapGuide.cpp
    KoSnapProxy.cpp
    KoSnapStrategy.cpp
    SnapGuideConfigWidget.cpp
    KoShapeShadow.cpp
    KoSharedSavingData.cpp
    KoSharedLoadingData.cpp
    KoViewConverter.cpp
    KoEventAction.cpp
    KEventActionFactoryBase.cpp
    KEventActionRegistry.cpp
    KImageData.cpp
    KImageData_p.cpp
    KImageCollection.cpp
    KoOdfWorkaround.cpp
    KFilterEffect.cpp
    KFilterEffectStack.cpp
    KFilterEffectFactoryBase.cpp
    KFilterEffectRegistry.cpp
    KFilterEffectConfigWidgetBase.cpp
    KFilterEffectRenderContext.cpp
    KFilterEffectLoadingContext.cpp
    KoTextOnShapeContainer.cpp
    KoTextShapeDataBase.cpp
    KoPluginLoader.cpp
    commands/KoShapeGroupCommand.cpp
    commands/KoShapeAlignCommand.cpp
    commands/KoShapeBackgroundCommand.cpp
    commands/KoShapeBorderCommand.cpp
    commands/KoShapeCreateCommand.cpp
    commands/KoShapeDeleteCommand.cpp
    commands/KoShapeDistributeCommand.cpp
    commands/KoShapeLockCommand.cpp
    commands/KoShapeMoveCommand.cpp
    commands/KoShapeShearCommand.cpp
    commands/KoShapeSizeCommand.cpp
    commands/KoShapeUngroupCommand.cpp
    commands/KoShapeReorderCommand.cpp
    commands/KoShapeKeepAspectRatioCommand.cpp
    commands/KoPathBaseCommand.cpp
    commands/KoPathPointMoveCommand.cpp
    commands/KoPathControlPointMoveCommand.cpp
    commands/KoPathPointTypeCommand.cpp
    commands/KoPathPointRemoveCommand.cpp
    commands/KoPathPointInsertCommand.cpp
    commands/KoPathSegmentBreakCommand.cpp
    commands/KoPathBreakAtPointCommand.cpp
    commands/KoPathSegmentTypeCommand.cpp
    commands/KoPathCombineCommand.cpp
    commands/KoPathSeparateCommand.cpp
    commands/KoSubpathRemoveCommand.cpp
    commands/KoSubpathJoinCommand.cpp
    commands/KoParameterHandleMoveCommand.cpp
    commands/KoParameterToPathCommand.cpp
    commands/KoShapeTransformCommand.cpp
    commands/KoPathFillRuleCommand.cpp
    commands/KoShapeShadowCommand.cpp
    commands/KoPathReverseCommand.cpp
    commands/KoEventActionAddCommand.cpp
    commands/KEventActionRemoveCommand.cpp
    commands/KoShapeRenameCommand.cpp
    commands/KoPathPointMergeCommand.cpp
    commands/KoShapeTransparencyCommand.cpp
    tools/KCreatePathTool.cpp
    tools/KCreatePathToolFactory.cpp
    tools/KoCreateShapeStrategy.cpp
    tools/KoPathToolFactory.cpp
    tools/KoPathTool.cpp
    tools/KoPathToolSelection.cpp
    tools/KoPathToolHandle.cpp
    tools/PathToolOptionWidget.cpp
    tools/KoPathPointRubberSelectStrategy.cpp
    tools/KoPathPointMoveStrategy.cpp
    tools/KoPathControlPointMoveStrategy.cpp
    tools/KoParameterChangeStrategy.cpp
    tools/KoZoomTool.cpp
    tools/KoZoomToolFactory.cpp
    tools/KoZoomToolWidget.cpp
    tools/KoZoomStrategy.cpp
    tools/KPanTool.cpp
    tools/KPanToolFactory.cpp
    tools/KInteractionTool.cpp
    tools/KInteractionStrategy.cpp
    tools/KoCreateShapesTool.cpp
    tools/KoCreateShapesToolFactory.cpp
    tools/KoShapeRubberSelectStrategy.cpp
    tools/KoPathSegmentChangeStrategy.cpp
)

kde4_add_ui_files(flake_SRCS
    tools/PathToolOptionWidget.ui
    SnapGuideConfigWidget.ui
    tools/KoZoomToolWidget.ui
)

kde4_add_library(flake SHARED ${flake_SRCS})

target_link_libraries(flake ${KDE4_KDEUI_LIBS} koodf)

target_link_libraries(flake LINK_INTERFACE_LIBRARIES koodf)

set_target_properties(flake PROPERTIES
    VERSION ${GENERIC_KOFFICE_LIB_VERSION} SOVERSION ${GENERIC_KOFFICE_LIB_SOVERSION}
)

########### install files ###############

install(TARGETS flake  ${INSTALL_TARGETS_DEFAULT_ARGS})
install( FILES
    flake.desktop
    flaketool.desktop
    flakeshape.desktop
    presentationeventaction.desktop
    scripteventaction.desktop
    filtereffect.desktop
    DESTINATION ${SERVICETYPES_INSTALL_DIR})

install(
    FILES
    commands/KoEventActionAddCommand.h
    commands/KEventActionRemoveCommand.h
    commands/KoParameterToPathCommand.h
    commands/KoPathCombineCommand.h
    commands/KoPathControlPointMoveCommand.h
    commands/KoPathFillRuleCommand.h
    commands/KoPathPointInsertCommand.h
    commands/KoPathPointMergeCommand.h
    commands/KoPathPointMoveCommand.h
    commands/KoPathPointRemoveCommand.h
    commands/KoPathReverseCommand.h
    commands/KoPathSegmentTypeCommand.h
    commands/KoPathSeparateCommand.h
    commands/KoShapeAlignCommand.h
    commands/KoShapeBackgroundCommand.h
    commands/KoShapeBorderCommand.h
    commands/KoShapeCreateCommand.h
    commands/KoShapeDeleteCommand.h
    commands/KoShapeDistributeCommand.h
    commands/KoShapeGroupCommand.h
    commands/KoShapeKeepAspectRatioCommand.h
    commands/KoShapeLockCommand.h
    commands/KoShapeMoveCommand.h
    commands/KoShapeRenameCommand.h
    commands/KoShapeReorderCommand.h
    commands/KoShapeShadowCommand.h
    commands/KoShapeShearCommand.h
    commands/KoShapeSizeCommand.h
    commands/KoShapeTransformCommand.h
    commands/KoShapeTransparencyCommand.h
    commands/KoShapeUngroupCommand.h
    commands/KoSubpathRemoveCommand.h
    flake_export.h
    KCanvasBase.h
    KCanvasController.h
    KCanvasObserverBase.h
    KCanvasSupervisor.h
    KColorBackground.h
    KCopyController.h
    KoCutController.h
    KoDataCenterBase.h
    KoDockFactoryBase.h
    KoDockRegistry.h
    KoDrag.h
    KoDragOdfSaveHelper.h
    KEventActionFactoryBase.h
    KoEventAction.h
    KEventActionRegistry.h
    KFilterEffectConfigWidgetBase.h
    KFilterEffectFactoryBase.h
    KFilterEffect.h
    KFilterEffectLoadingContext.h
    KFilterEffectRegistry.h
    KFilterEffectRenderContext.h
    KFilterEffectStack.h
    KoFlake.h
    KFrameShape.h
    KGradientBackground.h
    KGuidesData.h
    KImageCollection.h
    KImageData.h
    KInputDevice.h
    KoInsets.h
    KLineBorder.h
    KLoadingShapeUpdater.h
    KoOdfWorkaround.h
    KoParameterShape.h
    KoPasteController.h
    KoPathPointData.h
    KoPathPoint.h
    KoPathSegment.h
    KoPathShape.h
    KoPathShapeLoader.h
    KoPatternBackground.h
    KoPluginLoader.h
    KoPointerEvent.h
    KoPostscriptPaintDevice.h
    KoResourceManager.h
    KoRTree.h
    KoSelection.h
    KoShapeApplicationData.h
    KoShapeBackground.h
    KoShapeBorderBase.h
    KoShapeBorderFactoryBase.h
    KoShapeBorderRegistry.h
    KoShapeConfigWidgetBase.h
    KoShapeConnection.h
    KoShapeConnectionPolicy.h
    KoShapeContainerDefaultModel.h
    KoShapeContainer.h
    KoShapeContainerModel.h
    KoShapeControllerBase.h
    KoShapeController.h
    KoShapeFactoryBase.h
    KoShapeGroup.h
    KoShape.h
    KoShapeLayer.h
    KoShapeLoadingContext.h
    KoShapeManager.h
    KoShapeManagerPaintingStrategy.h
    KoShapeOdfSaveHelper.h
    KoShapePainter.h
    KoShapePaste.h
    KoShapeRegistry.h
    KoShapeSavingContext.h
    KoShapeShadow.h
    KoShapeUserData.h
    KoSharedLoadingData.h
    KoSharedSavingData.h
    KoSnapGuide.h
    KoTextOnShapeContainer.h
    KoTextShapeDataBase.h
    KoToolBase.h
    KoToolFactoryBase.h
    KoToolManager.h
    KoToolProxy.h
    KoToolRegistry.h
    KoToolSelection.h
    KoViewConverter.h
    tools/KoCreateShapesTool.h
    tools/KInteractionStrategy.h
    tools/KInteractionTool.h
    tools/KoShapeRubberSelectStrategy.h
    DESTINATION
    ${INCLUDE_INSTALL_DIR} COMPONENT Devel
)
