project(flake)

include_directories(${FLAKE_INCLUDES} ${QT_INCLUDES})

if(KDE4_BUILD_TESTS)
    # only with this definition will the FLAKE_TEST_EXPORT macro do something
    add_definitions(-DCOMPILING_TESTS)
endif(KDE4_BUILD_TESTS)

add_subdirectory(tests)
add_subdirectory(pics)

set(flake_SRCS
    KoFlake.cpp
    KCanvasBase.cpp
    KoResourceManager.cpp
    KCanvasObserverBase.cpp
    KCanvasSupervisor.cpp
    KCutController.cpp
    KCopyController.cpp
    KDockFactoryBase.cpp
    KDockRegistry.cpp
    KDataCenterBase.cpp
    KoInsets.cpp
    KPasteController.cpp
    KGuidesData.cpp
    KPathShape.cpp
    KPathPoint.cpp
    KPathPointData.cpp
    KPathSegment.cpp
    KoSelection.cpp
    KoShape.cpp
    KoShapeConnection.cpp
    KoShapeConnectionPolicy.cpp
    KoShapeControllerBase.cpp
    KoShapeApplicationData.cpp
    KoShapeContainer.cpp
    KoShapeContainerModel.cpp
    KoShapeContainerDefaultModel.cpp
    KoShapeGroup.cpp
    KoShapeManagerPaintingStrategy.cpp
    KoShapeManager.cpp
    KoShapePainter.cpp
    KFrameShape.cpp
    KoToolBase.cpp
    KCanvasController.cpp
    KCanvasController_p.cpp
    KoShapeRegistry.cpp
    KoToolFactoryBase.cpp
    KPathShapeFactory.cpp
    KoShapeFactoryBase.cpp
    KoShapeUserData.cpp
    KoPointGroup.cpp
    KParameterShape.cpp
    KoPointerEvent.cpp
    KoShapeController.cpp
    KoToolSelection.cpp
    KoShapeLayer.cpp
    KoPostscriptPaintDevice.cpp
    KInputDevice.cpp
    KoToolManager_p.cpp
    KoToolManager.cpp
    KoToolRegistry.cpp
    KoToolProxy.cpp
    KoShapeSavingContext.cpp
    KoShapeLoadingContext.cpp
    KLoadingShapeUpdater.cpp
    KoPathShapeLoader.cpp
    ShapeDeleter_p.cpp
    KoShapeBorderBase.cpp
    KoShapeBorderFactoryBase.cpp
    KoShapeBorderRegistry.cpp
    KLineBorder.cpp
    KLineBorderFactory.cpp
    KoShapeBackground.cpp
    KColorBackground.cpp
    KGradientBackground.cpp
    KoPatternBackground.cpp
    KoShapeConfigWidgetBase.cpp
    KDrag.cpp
    KDragOdfSaveHelper.cpp
    KoShapeOdfSaveHelper.cpp
    KoShapePaste.cpp
    KoSnapGuide.cpp
    KoSnapProxy.cpp
    KoSnapStrategy.cpp
    SnapGuideConfigWidget.cpp
    KoShapeShadow.cpp
    KoSharedSavingData.cpp
    KoSharedLoadingData.cpp
    KoViewConverter.cpp
    KEventAction.cpp
    KEventActionFactoryBase.cpp
    KEventActionRegistry.cpp
    KImageData.cpp
    KImageData_p.cpp
    KImageCollection.cpp
    KoOdfWorkaround.cpp
    KFilterEffect.cpp
    KFilterEffectStack.cpp
    KFilterEffectFactoryBase.cpp
    KFilterEffectRegistry.cpp
    KFilterEffectConfigWidgetBase.cpp
    KFilterEffectRenderContext.cpp
    KFilterEffectLoadingContext.cpp
    KoTextOnShapeContainer.cpp
    KoTextShapeDataBase.cpp
    KoPluginLoader.cpp
    commands/KoShapeGroupCommand.cpp
    commands/KoShapeAlignCommand.cpp
    commands/KoShapeBackgroundCommand.cpp
    commands/KoShapeBorderCommand.cpp
    commands/KoShapeCreateCommand.cpp
    commands/KoShapeDeleteCommand.cpp
    commands/KoShapeDistributeCommand.cpp
    commands/KoShapeLockCommand.cpp
    commands/KoShapeMoveCommand.cpp
    commands/KoShapeShearCommand.cpp
    commands/KoShapeSizeCommand.cpp
    commands/KoShapeUngroupCommand.cpp
    commands/KoShapeReorderCommand.cpp
    commands/KoShapeKeepAspectRatioCommand.cpp
    commands/KPathBaseCommand.cpp
    commands/KPathPointMoveCommand.cpp
    commands/KPathControlPointMoveCommand.cpp
    commands/KPathPointTypeCommand.cpp
    commands/KPathPointRemoveCommand.cpp
    commands/KPathPointInsertCommand.cpp
    commands/KPathSegmentBreakCommand.cpp
    commands/KPathBreakAtPointCommand.cpp
    commands/KPathSegmentTypeCommand.cpp
    commands/KPathCombineCommand.cpp
    commands/KPathSeparateCommand.cpp
    commands/KoSubpathRemoveCommand.cpp
    commands/KoSubpathJoinCommand.cpp
    commands/KParameterHandleMoveCommand.cpp
    commands/KParameterToPathCommand.cpp
    commands/KoShapeTransformCommand.cpp
    commands/KPathFillRuleCommand.cpp
    commands/KoShapeShadowCommand.cpp
    commands/KPathReverseCommand.cpp
    commands/KEventActionAddCommand.cpp
    commands/KEventActionRemoveCommand.cpp
    commands/KoShapeRenameCommand.cpp
    commands/KPathPointMergeCommand.cpp
    commands/KoShapeTransparencyCommand.cpp
    tools/KCreatePathTool.cpp
    tools/KCreatePathToolFactory.cpp
    tools/KCreateShapeStrategy.cpp
    tools/KoPathToolFactory.cpp
    tools/KoPathTool.cpp
    tools/KoPathToolSelection.cpp
    tools/KoPathToolHandle.cpp
    tools/PathToolOptionWidget.cpp
    tools/KPathPointRubberSelectStrategy.cpp
    tools/KPathPointMoveStrategy.cpp
    tools/KPathControlPointMoveStrategy.cpp
    tools/KParameterChangeStrategy.cpp
    tools/KoZoomTool.cpp
    tools/KoZoomToolFactory.cpp
    tools/KoZoomToolWidget.cpp
    tools/KoZoomStrategy.cpp
    tools/KPanTool.cpp
    tools/KPanToolFactory.cpp
    tools/KInteractionTool.cpp
    tools/KInteractionStrategy.cpp
    tools/KCreateShapesTool.cpp
    tools/KCreateShapesToolFactory.cpp
    tools/KoShapeRubberSelectStrategy.cpp
    tools/KPathSegmentChangeStrategy.cpp
)

kde4_add_ui_files(flake_SRCS
    tools/PathToolOptionWidget.ui
    SnapGuideConfigWidget.ui
    tools/KoZoomToolWidget.ui
)

kde4_add_library(flake SHARED ${flake_SRCS})

target_link_libraries(flake ${KDE4_KDEUI_LIBS} koodf)

target_link_libraries(flake LINK_INTERFACE_LIBRARIES koodf)

set_target_properties(flake PROPERTIES
    VERSION ${GENERIC_KOFFICE_LIB_VERSION} SOVERSION ${GENERIC_KOFFICE_LIB_SOVERSION}
)

########### install files ###############

install(TARGETS flake  ${INSTALL_TARGETS_DEFAULT_ARGS})
install( FILES
    flake.desktop
    flaketool.desktop
    flakeshape.desktop
    presentationeventaction.desktop
    scripteventaction.desktop
    filtereffect.desktop
    DESTINATION ${SERVICETYPES_INSTALL_DIR})

install(
    FILES
    commands/KEventActionAddCommand.h
    commands/KEventActionRemoveCommand.h
    commands/KParameterToPathCommand.h
    commands/KPathCombineCommand.h
    commands/KPathControlPointMoveCommand.h
    commands/KPathFillRuleCommand.h
    commands/KPathPointInsertCommand.h
    commands/KPathPointMergeCommand.h
    commands/KPathPointMoveCommand.h
    commands/KPathPointRemoveCommand.h
    commands/KPathReverseCommand.h
    commands/KPathSegmentTypeCommand.h
    commands/KPathSeparateCommand.h
    commands/KoShapeAlignCommand.h
    commands/KoShapeBackgroundCommand.h
    commands/KoShapeBorderCommand.h
    commands/KoShapeCreateCommand.h
    commands/KoShapeDeleteCommand.h
    commands/KoShapeDistributeCommand.h
    commands/KoShapeGroupCommand.h
    commands/KoShapeKeepAspectRatioCommand.h
    commands/KoShapeLockCommand.h
    commands/KoShapeMoveCommand.h
    commands/KoShapeRenameCommand.h
    commands/KoShapeReorderCommand.h
    commands/KoShapeShadowCommand.h
    commands/KoShapeShearCommand.h
    commands/KoShapeSizeCommand.h
    commands/KoShapeTransformCommand.h
    commands/KoShapeTransparencyCommand.h
    commands/KoShapeUngroupCommand.h
    commands/KoSubpathRemoveCommand.h
    flake_export.h
    KCanvasBase.h
    KCanvasController.h
    KCanvasObserverBase.h
    KCanvasSupervisor.h
    KColorBackground.h
    KCopyController.h
    KCutController.h
    KDataCenterBase.h
    KDockFactoryBase.h
    KDockRegistry.h
    KDrag.h
    KDragOdfSaveHelper.h
    KEventActionFactoryBase.h
    KEventAction.h
    KEventActionRegistry.h
    KFilterEffectConfigWidgetBase.h
    KFilterEffectFactoryBase.h
    KFilterEffect.h
    KFilterEffectLoadingContext.h
    KFilterEffectRegistry.h
    KFilterEffectRenderContext.h
    KFilterEffectStack.h
    KoFlake.h
    KFrameShape.h
    KGradientBackground.h
    KGuidesData.h
    KImageCollection.h
    KImageData.h
    KInputDevice.h
    KoInsets.h
    KLineBorder.h
    KLoadingShapeUpdater.h
    KoOdfWorkaround.h
    KParameterShape.h
    KPasteController.h
    KPathPointData.h
    KPathPoint.h
    KPathSegment.h
    KPathShape.h
    KoPathShapeLoader.h
    KoPatternBackground.h
    KoPluginLoader.h
    KoPointerEvent.h
    KoPostscriptPaintDevice.h
    KoResourceManager.h
    KoRTree.h
    KoSelection.h
    KoShapeApplicationData.h
    KoShapeBackground.h
    KoShapeBorderBase.h
    KoShapeBorderFactoryBase.h
    KoShapeBorderRegistry.h
    KoShapeConfigWidgetBase.h
    KoShapeConnection.h
    KoShapeConnectionPolicy.h
    KoShapeContainerDefaultModel.h
    KoShapeContainer.h
    KoShapeContainerModel.h
    KoShapeControllerBase.h
    KoShapeController.h
    KoShapeFactoryBase.h
    KoShapeGroup.h
    KoShape.h
    KoShapeLayer.h
    KoShapeLoadingContext.h
    KoShapeManager.h
    KoShapeManagerPaintingStrategy.h
    KoShapeOdfSaveHelper.h
    KoShapePainter.h
    KoShapePaste.h
    KoShapeRegistry.h
    KoShapeSavingContext.h
    KoShapeShadow.h
    KoShapeUserData.h
    KoSharedLoadingData.h
    KoSharedSavingData.h
    KoSnapGuide.h
    KoTextOnShapeContainer.h
    KoTextShapeDataBase.h
    KoToolBase.h
    KoToolFactoryBase.h
    KoToolManager.h
    KoToolProxy.h
    KoToolRegistry.h
    KoToolSelection.h
    KoViewConverter.h
    tools/KCreateShapesTool.h
    tools/KInteractionStrategy.h
    tools/KInteractionTool.h
    tools/KoShapeRubberSelectStrategy.h
    DESTINATION
    ${INCLUDE_INSTALL_DIR} COMPONENT Devel
)
